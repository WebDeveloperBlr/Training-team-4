<section class="candidate-profile-block" *ngIf='data' id="candidate-profile-block">
  <div class="candidate-profile__hr-app__nav-bar">
    <nav class="candidate-profile__breadcrumb" aria-label="breadcrumb">
      <ol class="profile-breadcrumb">
        <li class="breadcrumb-item"><a href="#" class="breadcrumb-link">Candidates</a></li>
        <li class="breadcrumb-item active" id="breadcrumbField">{{data.docs.name}}</li>
      </ol>
    </nav>
  </div>
  <div class="candidate-profile__hr-app__container-row row no-gutters">
    <div class="candidate-profile__hr-app__left-part col-3">
      <div class="candidate-profile__hr-app__candidate-preview">
        <div class="candidate-profile__cv-wrapper">
          <span class="candidate-profile__cv-status-label">Status: </span>
          <span class="candidate-profile__cv-status" *ngIf="!activeEdit">
            {{activePosition.status}}
          </span>
          <ng-select ngClass="custom-cand-details"
                     [items]="data.allStatuses"
                     bindLabel="name"
                     bindValue="name"
                     placeholder="Select value"
                     [(ngModel)]="activePosition.status"
                     *ngIf="activeEdit"></ng-select>
        </div>
        <div class="candidate-profile__img-preview">
          <img width="100%" height="100%" src="/assets/images/profiles/profile{{data.docs.id_candidate}}.jpg">
        </div>
        <div class="candidate-profile__candidate-wrapper">
          <div class="candidate-profile__candidate-wrapper__left-col" *ngIf="activeEdit">
            <div class="candidate-profile__candidate-wrapper__row">
              <span class="candidate-profile__candidate-label" *ngIf="activeEdit">Position</span>
            </div>
            <div class="candidate-profile__candidate-wrapper__row">
              <span class="candidate-profile__candidate-label" *ngIf="activeEdit">Name*</span>
            </div>
            <div class="candidate-profile__candidate-wrapper__row">
              <span class="candidate-profile__candidate-label" *ngIf="activeEdit">Salary</span>
            </div>

          </div>
          <div class="candidate-profile__candidate-wrapper__right-col" *ngIf="activeEdit">
            <div class="candidate-profile__candidate-wrapper__row">
              <ng-select ngClass="custom-cand-details-main" [items]="candidate.positions"
                         bindLabel="name"
                         bindValue="name"
                         placeholder="Select value"
                         [ngModel]="activePosition.name"
                         *ngIf="activeEdit"
                         #positionSelect
                         (change)="changePosition(positionSelect)"
              ></ng-select>
              <div class="add-button" (click)="openAddPositionModal(addPositionModal)" >
                <svg class="icon icon-PENCIL ">
                  <use xlink:href="assets/images/svg/symbol/sprite.svg#PENCIL"></use>
                </svg>
              </div>
            </div>
            <div class="candidate-profile__candidate-wrapper__row">
              <input
                class="cands-input-properties cands-input-properties&#45;&#45;ml candidate-profile__input"
                name="candidateName"
                #candidateName = "ngModel"
                [(ngModel)]="candidate.name"
                *ngIf="activeEdit"
                [ngClass]="{'border-danger' : (candidateName.touched || candidateName.dirty) && candidateName.invalid}"
                type="text"
                required>
            </div>
            <div class="candidate-profile__candidate-wrapper__row">
              <input class="cands-input-properties cands-input-properties&#45;&#45;ml candidate-profile__input"
                     name="candidateSalary"
                     #candidateSalary = "ngModel"
                     [ngClass]="{'border-danger' : (candidateSalary.touched || candidateSalary.dirty) && candidateSalary.invalid}"
                     [(ngModel)]="candidate.salary"
                     type="text"  *ngIf="activeEdit"
                     required>

            </div>
          </div>
          <div class="candidate-profile__candidate-wrapper__left-col" *ngIf="!activeEdit">

            <span class="candidate-profile__candidate-text candidate-position" *ngIf="!activeEdit">{{activePosition.name}}</span>
            <span class="candidate-profile__candidate-text candidate-name" *ngIf="!activeEdit">{{data.docs.name}}</span>
            <span class="candidate-profile__candidate-text candidate-salary" *ngIf="!activeEdit">{{data.docs.salary}}$</span>
          </div>

        </div>


        <ng-template class="modal fade" #addSkillModal let-c="close" let-d="dismiss">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="addSkillModalLabel">Add skill</h5>
                <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">

                <div class="skills-modal__search-wrapper">
                  <span class="skills-modal__search-label">Search</span>
                  <input type="search" class="skills-modal__search-input"/>
                </div>
                <div class="skills-modal__items-wrapper">
                  <div class="skills-modal__item" *ngFor="let item of data.allSkills; index" (click)="addSkill(item.name)">
                    <span class="skills-modal__item-text">{{item.name}}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-template>
        <ng-template class="modal fade" #addPositionModal let-c="close" let-d="dismiss">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title">Edit positions</h5>
                <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">

                <div class="position-input-wrapper">
                  <ng-select ngClass="custom-cand-details"
                             [items]="data.allPositions"
                             bindLabel="name"
                             bindValue="name"
                             placeholder="Select value"
                             [(ngModel)]="editPositionActive"
                             *ngIf="activeEdit"></ng-select>
                  <div class="add-button" (click)="addPosition()">
                    <span>Add</span>
                  </div>
                </div>
                <div class="skills-modal__items-wrapper">
                  <div class="skills-modal__item" *ngFor="let item of candidate.positions; let i = index" (click)="deletePosition(item.name, i)">
                    <span class="skills-modal__item-text">{{item.name}}</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </ng-template>

        <ng-template class="modal fade" #addExpModal let-c="close" let-d="dismiss">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="addExpModalLabel">Add Experience</h5>
                <button type="button" class="close" (click)="d('Cross click')" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">

                <div class="exp-modal__body-inner-wrap">
                  <div class="exp-modal__row">
                    <div class="exp-modal__row__left-col">
                      <div class="exp-modal__row__left-col-item">
                        <div class="exp-modal__row__inputs-wrapper">
                          <label class="font--light">Position</label>
                          <input type="text" class="exp-modal__row__left-col__exp-position-input"
                                 name="newExp-position" [(ngModel)]="newExp.position"/>
                        </div>
                        <div class="exp-modal__row__left-col__date-inputs-wrapper"><label
                          class="exp-modal__row__left-col__date-label" data-attr="date-label"
                          class="font--light">From</label>
                          <app-ngbdatepickerpopup (change)="addNewExpFrom($event)" [date]="newExp.dateStart" name="newExp-dateStart"></app-ngbdatepickerpopup>
                        </div>
                        <div class="exp-modal__row__left-col__date-inputs-wrapper"><label
                          class="exp-modal__row__left-col__date-label" data-attr="date-label">To</label>
                          <app-ngbdatepickerpopup (change)="addNewExpTo($event)" [date]="newExp.dateEnd" name="newExp-dateEnd"></app-ngbdatepickerpopup>

                        </div>
                      </div>
                    </div>
                    <div class="exp-modal__row__right-col">
                      <div class="exp-modal__row__right-col-item">
                        <div class="exp-modal__row__inputs-wrapper">
                          <label class="font--light">Company</label>
                          <input class="exp-modal__row__right-col__company-input" name="newExp-company" [(ngModel)]="newExp.company"
                                 type="text"/>
                        </div>
                        <div class="exp-modal__row__right-col__description-textarea-wrapper">
                          <label class="font--light">Info</label>
                          <textarea rows="3" name="newExp-info" [(ngModel)]="newExp.info"
                                    class="exp-modal__row__right-col__description-textarea"
                                    ></textarea>
                        </div>
                      </div>

                    </div>
                  </div>
                </div>

              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-primary" aria-label="Close" (click)="addExp()">Save changes
                </button>
              </div>
            </div>
          </div>
        </ng-template>

      </div>
      <div class="candidate-profile__hr-app__contact-info">
        <div class="contact-info__text">
          Contact Information
        </div>
        <div class="contact-info__telephone">
          Telephone:
          <p class="contact-info__data" *ngIf="!activeEdit">{{data.docs.telephone}}</p>
          <input class="cands-input-properties" [(ngModel)]="candidate.telephone" *ngIf="activeEdit" type="tel">
        </div>
        <div class="contact-info__email">
          Email:
          <p class="contact-info__data" *ngIf="!activeEdit">{{data.docs.email}}</p>
          <input class="cands-input-properties" [(ngModel)]="candidate.email" *ngIf="activeEdit" type="email">
        </div>
        <div class="contact-info__address">
          Address:
          <p class="contact-info__data" *ngIf="!activeEdit">{{data.docs.address}}</p>
          <input class="cands-input-properties" [(ngModel)]="candidate.address" *ngIf="activeEdit" type="text">
        </div>
      </div>
    </div>
    <div class="candidate-profile__hr-app__right-part col-9">
      <div class="cands-exp">
        <div class="cands-exp__header-wrapper ">
          <div class="cands-exp__header">
            <span>Experience</span>
            <div class="add-button add-button--small" *ngIf="activeEdit" (click)="openExpAdd(addExpModal)"><span>+</span></div>
          </div>

        </div>
        <div class="cands-exp__rows-wrapper" *ngIf="data && data.docs && data.docs.exp">

          <div class="cands-exp__row" *ngFor="let item of data.docs.exp; let i = index">
            <div class="cands-exp__row-left-part">
              <div class="cands-exp__left-part-item">
                <div class="cands-exp__left-part-date">
                  <div class="exp-description date-label" *ngIf="!activeEdit">{{(item.dateStart | date) + " - " + (item.dateEnd | date)}}</div>
                </div>
                <div class="exp-description cands-exp__left-part-description" *ngIf="!activeEdit">{{item.position}}
                </div>
                <input type="text" class="candidate-profile__exp-position-input"
                       [(ngModel)]="item.position"
                       *ngIf="activeEdit">
                <div class="candidate-profile__date-inputs-wrapper">
                  <label class="candidate-profile__date-label"
                         *ngIf="activeEdit">From</label>
                  <app-ngbdatepickerpopup (change)="onChangeFrom($event, i)" [date] ="item.dateStart" *ngIf="activeEdit"></app-ngbdatepickerpopup>
                </div>
                <div class="candidate-profile__date-inputs-wrapper"><label class="candidate-profile__date-label"
                                                                           *ngIf="activeEdit">To</label>
                  <app-ngbdatepickerpopup (change)="onChangeTo($event ,i)" [date] = "item.dateEnd" *ngIf="activeEdit"></app-ngbdatepickerpopup>

                </div>
              </div>
            </div>
            <div class="cands-exp__row-right-part">
              <div class="cands-exp__right-part-item">
                <div class="cands-exp__right-part-item__delete-button" (click)="deleteExp(i)"
                     *ngIf="activeEdit">
                  <svg class="icon icon-bin ">
                    <use xmlns:xlink="http://www.w3.org/1999/xlink"
                         xlink:href="assets/images/svg/symbol/sprite.svg#bin"></use>
                  </svg>
                </div>
                <div class="cands-exp__right-part-item-header" *ngIf="!activeEdit">{{item.company}}</div>
                <input class="cands-exp__right-part-item-companyInput" [(ngModel)]="item.company" *ngIf="activeEdit"
                       type="text">
                <div class="exp-description cands-exp__right-part-item-description " *ngIf="!activeEdit">{{item.info}}
                </div>
                <textarea rows="3" data-attr="expInfoInput"
                          class="cands-exp__right-part-item-description-textarea" [(ngModel)]="item.info" *ngIf="activeEdit">                        </textarea>
              </div>
            </div>
          </div>

        </div>
      </div>
      <div class="candidate-profile__hr-app__skills">
        <div class="skills__text">Skills</div>
        <div class="candidate-profile__hr-app__skills-wrapper">
          <div class="skills__elements" *ngIf="data && data.docs && data.docs.skills">
            <span class="skills__elements__decoration"
                  (click)="deleteSkill(item.name)"
                  [ngClass]="{'skill--deletable' : activeEdit}"
                  *ngFor="let item of data.docs.skills">{{item.name}}</span>
          </div>
          <div class="add-button" (click)="openSkillAdd(addSkillModal)" *ngIf="activeEdit">
            <span>+</span></div>
        </div>


        <div class="success-button-wrap round--55 bg-success">
          <svg class="icon icon-CHECK ">
            <use xlink:href="assets/images/svg/symbol/sprite.svg#CHECK"></use>
          </svg>
        </div>
        <div class="error-button-wrap round--55 bg-danger" id="cands-error-button">
          <svg class="icon icon-CLOSE ">
            <use xlink:href="assets/images/svg/symbol/sprite.svg#CLOSE"></use>
          </svg>
        </div>
        <div class="edit-button-wrap round--55 bg-warning" *ngIf="!activeEdit" (click)="toggleToEditable()">
          <svg class="icon icon-PENCIL ">
            <use xlink:href="assets/images/svg/symbol/sprite.svg#PENCIL"></use>
          </svg>
        </div>
        <div class="save-button-wrap round--55 bg-primary" *ngIf="activeEdit" (click)="saveData()">
          <svg class="icon icon-save ">
            <use xlink:href="assets/images/svg/symbol/sprite.svg#save"></use>
          </svg>
        </div>

      </div>
    </div>
  </div>
</section>
